<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex flex-col items-center justify-center min-h-screen bg-gray-100">
    <div class="w-96 p-6 bg-white shadow-lg rounded-lg text-center">        
        <h2 class="text-2xl font-semibold mb-2 text-gray-800">Profile</h2>

        <!-- Profile Avatar -->
        <div class="flex justify-center mb-4">
            <img id="avatar" src="profile.webp" alt="Profile Avatar" class="w-24 h-24 rounded-full border-2 border-gray-300">
        </div>

        <!-- Welcome Message -->
        <p id="welcomeMessage" class="text-lg font-medium text-gray-700 mb-4"></p>
        
        <!-- Editable User Info -->
        <div class="text-left">
            <label class="text-sm text-gray-600">First Name</label>
            <input id="firstName" type="text" class="w-full p-2 border border-gray-300 rounded-lg mb-2 focus:outline-none focus:ring-2 focus:ring-blue-400">
            
            <label class="text-sm text-gray-600">Last Name</label>
            <input id="lastName" type="text" class="w-full p-2 border border-gray-300 rounded-lg mb-2 focus:outline-none focus:ring-2 focus:ring-blue-400">

            <label class="text-sm text-gray-600">Email</label>
            <input id="email" type="email" class="w-full p-2 border border-gray-300 rounded-lg mb-2 focus:outline-none focus:ring-2 focus:ring-blue-400">

            <label class="text-sm text-gray-600">Phone Number</label>
            <input id="phone" type="tel" class="w-full p-2 border border-gray-300 rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-blue-400">
        </div>

        <!-- Buttons -->
        <button onclick="saveProfile()" class="w-full p-2 bg-blue-500 text-white rounded-lg hover:bg-blue-700 transition duration-300 mb-2">
            Save Changes
        </button>
        
        <button onclick="logout()" class="w-full p-2 bg-red-500 text-white rounded-lg hover:bg-red-700 transition duration-300">
            Logout
        </button>
    </div>

    <script>
        function loadProfile() {
            const loggedInUserString = localStorage.getItem("loggedInUser");

            if (!loggedInUserString) {
                alert("Session expired! Redirecting to login.");
                window.location.href = "login.html";
                return;
            }

            try {
                const loggedInUser = JSON.parse(loggedInUserString);
                
                // Populate the input fields with user data
                document.getElementById("firstName").value = loggedInUser.firstName;
                document.getElementById("lastName").value = loggedInUser.lastName;
                document.getElementById("email").value = loggedInUser.email || "";
                document.getElementById("phone").value = loggedInUser.phone || "";

                // Update the welcome message
                document.getElementById("welcomeMessage").innerText = `Welcome, ${loggedInUser.firstName} ${loggedInUser.lastName}!`;
            
            } catch (error) {
                console.error("Error parsing user data:", error);
            }
        }

        function saveProfile() {
            const updatedUser = {
                firstName: document.getElementById("firstName").value,
                lastName: document.getElementById("lastName").value,
                email: document.getElementById("email").value,
                phone: document.getElementById("phone").value
            };

            // Save updated user info in localStorage
            localStorage.setItem("loggedInUser", JSON.stringify(updatedUser));
            
            // Reload the page to reflect changes
            location.reload();
        }

        function logout() {
            localStorage.removeItem("loggedInUser");
            window.location.href = "login.html";
        }

        document.addEventListener("DOMContentLoaded", loadProfile);
    </script>
</body>
</html>
